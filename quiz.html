<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ø®ØªØ¨Ø§Ø± ØªÙØ§Ø¹Ù„ÙŠ</title>
<style>
  :root{
    --bg:#121212;
    --card:#1f1f1f;
    --accent:#4c8eff;
    --text:#fff;
    --muted:#ccc;
    --radius:12px;
  }
  body {
    margin:0;
    font-family: "Segoe UI", Tahoma, Arial, sans-serif;
    background:var(--bg);
    display:flex;
    justify-content:center;
    padding:30px;
    color:var(--text);
  }
  .container{
    width:100%;
    max-width:700px;
  }
  .card{
    background:var(--card);
    padding:20px;
    border-radius:var(--radius);
    margin-bottom:20px;
    box-shadow:0 6px 18px rgba(0,0,0,0.5);
  }
  .question{ font-size:20px; margin-bottom:12px; }
  .choices{ display:flex; flex-direction:column; gap:10px; }
  .choice{ background:#2b2b2b; padding:10px 12px; border-radius:8px; cursor:pointer; border:1px solid #444; transition:0.2s; }
  .choice:hover{ background:#3a3a3a; }
  .choice.selected{ background:linear-gradient(90deg,var(--accent),#2b6aff); border-color:var(--accent); }
  .actions{ display:flex; justify-content:center; gap:10px; margin-top:16px; flex-wrap:wrap; }
  .btn{ padding:10px 18px; border:none; border-radius:8px; cursor:pointer; font-weight:600; }
  .btn-primary{ background:var(--accent); color:white; }
  .btn-ghost{ background:transparent; color:var(--accent); border:1px solid #444; }
  .summary{ text-align:center; padding:18px; }
  .score{ font-size:32px; margin:10px 0; }
  .small{ color:var(--muted); font-size:14px; }
  @media(max-width:520px){ .question{ font-size:18px; } }
</style>
</head>
<body>
<div class="container">
  <div class="card" id="quizArea">
    <div class="question" id="questionText">Ø³Ø¤Ø§Ù„</div>
    <div class="choices" id="choicesList"></div>
    <div class="actions">
      <button id="prevBtn" class="btn btn-ghost">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
      <button id="nextBtn" class="btn btn-primary">Ø§Ù„ØªØ§Ù„ÙŠ</button>
    </div>
  </div>

  <div class="card" id="resultArea" style="display:none;">
    <div class="summary">
      <div class="small">Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</div>
      <div class="score" id="scoreText">0 / 0</div>
      <div class="small" id="feedbackText">ØªØ´Ø¬ÙŠØ¹</div>
      <div style="margin-top:14px">
        <button id="retryBtn" class="btn btn-primary">Ø£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
      </div>
    </div>
  </div>
</div>

<script>
// Ø¬Ù„Ø¨ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨
const userName = sessionStorage.getItem("userName") || "Ø·Ø§Ù„Ø¨";
const userEmail = sessionStorage.getItem("userEmail") || "example@example.com";

// Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
const questions = [
  {q:"Ø¹Ø§ØµÙ…Ø© Ù…ØµØ± Ù‡ÙŠ Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©.", type:"tf", choices:["ØµØ­","Ø®Ø·Ø£"], correct:0},
  {q:"Ø£ÙƒØ¨Ø± ÙƒÙˆÙƒØ¨ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ù…Ø³ÙŠØ© Ù‡Ùˆ Ø§Ù„Ù…Ø´ØªØ±ÙŠ.", type:"tf", choices:["ØµØ­","Ø®Ø·Ø£"], correct:0},
  {q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ù„ÙˆØ§Ù† Ù‚ÙˆØ³ Ù‚Ø²Ø­ØŸ", type:"mc", choices:["5","6","7","8"], correct:2},
  {q:"Ø£Ù‚ØµØ± Ø´Ù‡Ø± ÙÙŠ Ø§Ù„Ø³Ù†Ø© Ù‡Ùˆ ÙØ¨Ø±Ø§ÙŠØ±.", type:"tf", choices:["ØµØ­","Ø®Ø·Ø£"], correct:0},
  {q:"Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ø¨Ø±Ø§Ø²ÙŠÙ„ØŸ", type:"mc", choices:["Ø§Ù„Ø¨Ø±ØªØºØ§Ù„ÙŠØ©","Ø§Ù„Ø¥Ø³Ø¨Ø§Ù†ÙŠØ©","Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©","Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©"], correct:0},
  {q:"Ø§Ù„Ø¶ÙˆØ¡ ÙŠÙ†ØªÙ‚Ù„ Ø£Ø³Ø±Ø¹ Ù…Ù† Ø§Ù„ØµÙˆØª.", type:"tf", choices:["ØµØ­","Ø®Ø·Ø£"], correct:0},
  {q:"ÙƒÙ… Ø¹Ø¯Ø¯ Ø§Ù„Ù‚Ø§Ø±Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", type:"mc", choices:["5","6","7","8"], correct:2},
  {q:"Ø§Ù„Ø¨Ø±Ù…Ø¬Ø© Ù‡ÙŠ Ø¹Ù…Ù„ÙŠØ© ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø£ÙˆØ§Ù…Ø± Ù„Ù„Ø­Ø§Ø³ÙˆØ¨.", type:"tf", choices:["ØµØ­","Ø®Ø·Ø£"], correct:0},
  {q:"Ø£ÙŠ Ù…Ù† Ø§Ù„Ø­ÙŠÙˆØ§Ù†Ø§Øª Ø§Ù„ØªØ§Ù„ÙŠØ© Ø«Ø¯ÙŠÙŠØ§ØªØŸ", type:"mc", choices:["Ø§Ù„ØªÙ…Ø³Ø§Ø­","Ø§Ù„Ø­ÙˆØª","Ø§Ù„Ø³Ù„Ø­ÙØ§Ø©","Ø§Ù„Ø®ÙØ§Ø´"], correct:1},
  {q:"Ø§Ù„Ø´Ù…Ø³ ØªØ¯ÙˆØ± Ø­ÙˆÙ„ Ø§Ù„Ø£Ø±Ø¶.", type:"tf", choices:["ØµØ­","Ø®Ø·Ø£"], correct:1}
];

let index=0;
let answers=new Array(questions.length).fill(null);

// Ø¹Ù†Ø§ØµØ± DOM
const qText=document.getElementById('questionText');
const choicesList=document.getElementById('choicesList');
const prevBtn=document.getElementById('prevBtn');
const nextBtn=document.getElementById('nextBtn');
const quizArea=document.getElementById('quizArea');
const resultArea=document.getElementById('resultArea');
const scoreText=document.getElementById('scoreText');
const feedbackText=document.getElementById('feedbackText');

function renderQuestion(i){
  const item=questions[i];
  qText.textContent=`Ø§Ù„Ø³Ø¤Ø§Ù„ ${i+1}: ${item.q}`;
  choicesList.innerHTML='';
  item.choices.forEach((c,ci)=>{
    const d=document.createElement('div');
    d.className='choice';
    d.dataset.index=ci;
    d.innerText=c;
    if(answers[i]===ci) d.classList.add('selected');
    d.addEventListener('click',()=>selectChoice(ci));
    choicesList.appendChild(d);
  });
  prevBtn.disabled=(i===0);
  nextBtn.textContent=(i===questions.length-1)?'Ø¥Ø±Ø³Ø§Ù„':'Ø§Ù„ØªØ§Ù„ÙŠ';
}

function selectChoice(ci){
  answers[index]=ci;
  Array.from(choicesList.children).forEach(ch=>{
    ch.classList.toggle('selected',Number(ch.dataset.index)===ci);
  });
}

prevBtn.addEventListener('click',()=>{
  if(index>0) index--;
  renderQuestion(index);
});

nextBtn.addEventListener('click',()=>{
  if(index<questions.length-1){
    index++;
    renderQuestion(index);
  }else{
    finishQuiz();
  }
});

function finishQuiz(){
  let score=0;
  for(let i=0;i<questions.length;i++){
    if(answers[i]===questions[i].correct) score++;
  }
  scoreText.innerText=`${score} / ${questions.length}`;
  feedbackText.innerText=(score===questions.length)?'Ù…Ù…ØªØ§Ø²! ÙƒÙ„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª ØµØ­ÙŠØ­Ø© ğŸ‰':(score>=7?'Ø¬ÙŠØ¯ Ø¬Ø¯Ø§ ğŸ‘':'Ø­Ø§ÙˆÙ„ÙŠ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ âœ¨');

  // Ø­ÙØ¸ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© ÙÙŠ Ù…Ù„Ù TXT
  const now=new Date();
  const dateStr=`${now.getFullYear()}-${now.getMonth()+1}-${now.getDate()}_${now.getHours()}-${now.getMinutes()}`;
  let content=`Ø§Ù„Ø§Ø³Ù…: ${userName}\nØ§Ù„Ø¨Ø±ÙŠØ¯: ${userEmail}\nØ§Ù„ØªØ§Ø±ÙŠØ®: ${dateStr}\n\nØ§Ù„Ù†ØªØ§Ø¦Ø¬:\n`;
  questions.forEach((q,i)=>{
    const ans=answers[i]!==null?questions[i].choices[answers[i]]:"Ù„Ù… ÙŠØ¬ÙŠØ¨";
    content+=`${i+1}. ${q.q}\nØ¥Ø¬Ø§Ø¨ØªÙƒ: ${ans}\nØµØ­ÙŠØ­Ø©: ${q.choices[q.correct]}\n\n`;
  });
  const blob=new Blob([content],{type:"text/plain"});
  const link=document.createElement('a');
  link.href=URL.createObjectURL(blob);
  link.download=`${userName}_${dateStr}.txt`;
  link.click();

  quizArea.style.display='none';
  resultArea.style.display='block';
}

document.getElementById('retryBtn').addEventListener('click',()=>{
  answers=new Array(questions.length).fill(null);
  index=0;
  quizArea.style.display='block';
  resultArea.style.display='none';
  renderQuestion(index);
});

// Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
renderQuestion(0);
</script>
</body>
</html>
